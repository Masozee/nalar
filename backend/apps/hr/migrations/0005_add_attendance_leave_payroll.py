# Generated by Django 5.2.8 on 2025-11-22 16:44

import django.core.validators
import django.db.models.deletion
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('hr', '0004_add_office_fields'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='LeavePolicy',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('name', models.CharField(max_length=100)),
                ('leave_type', models.CharField(choices=[('annual', 'Cuti Tahunan'), ('sick', 'Cuti Sakit'), ('maternity', 'Cuti Melahirkan'), ('paternity', 'Cuti Ayah'), ('marriage', 'Cuti Menikah'), ('bereavement', 'Cuti Duka'), ('unpaid', 'Cuti Tanpa Gaji'), ('special', 'Cuti Khusus'), ('religious', 'Cuti Keagamaan')], max_length=20)),
                ('year', models.PositiveIntegerField()),
                ('default_days', models.PositiveIntegerField(help_text='Jumlah hari cuti default')),
                ('max_carry_over', models.PositiveIntegerField(default=0, help_text='Maksimal hari yang bisa dibawa ke tahun berikutnya')),
                ('requires_approval', models.BooleanField(default=True)),
                ('requires_document', models.BooleanField(default=False)),
                ('min_days_notice', models.PositiveIntegerField(default=0, help_text='Minimal hari pengajuan sebelum tanggal cuti')),
                ('description', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': 'Leave Policy',
                'verbose_name_plural': 'Leave Policies',
                'ordering': ['-year', 'leave_type'],
                'indexes': [models.Index(fields=['year', 'leave_type'], name='hr_leavepol_year_637f97_idx')],
                'unique_together': {('leave_type', 'year')},
            },
        ),
        migrations.CreateModel(
            name='PayrollPeriod',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('year', models.PositiveIntegerField()),
                ('month', models.PositiveIntegerField()),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('calculated', 'Dihitung'), ('approved', 'Disetujui'), ('paid', 'Dibayar'), ('cancelled', 'Dibatalkan')], default='draft', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('total_employees', models.PositiveIntegerField(default=0)),
                ('total_gross', models.DecimalField(decimal_places=2, default=0, max_digits=18)),
                ('total_deductions', models.DecimalField(decimal_places=2, default=0, max_digits=18)),
                ('total_net', models.DecimalField(decimal_places=2, default=0, max_digits=18)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Payroll Period',
                'verbose_name_plural': 'Payroll Periods',
                'ordering': ['-year', '-month'],
            },
        ),
        migrations.CreateModel(
            name='Payslip',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('basic_salary', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0'))])),
                ('total_allowances', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total_deductions', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('overtime_pay', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('gross_salary', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('net_salary', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('working_days', models.PositiveIntegerField(default=0)),
                ('present_days', models.PositiveIntegerField(default=0)),
                ('absent_days', models.PositiveIntegerField(default=0)),
                ('overtime_hours', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('payment_date', models.DateField(blank=True, null=True)),
                ('payment_method', models.CharField(blank=True, max_length=50)),
                ('payment_reference', models.CharField(blank=True, max_length=100)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('calculated', 'Dihitung'), ('approved', 'Disetujui'), ('paid', 'Dibayar'), ('cancelled', 'Dibatalkan')], default='draft', max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payslips', to='hr.employee')),
                ('payroll_period', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='payslips', to='hr.payrollperiod')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Payslip',
                'verbose_name_plural': 'Payslips',
                'ordering': ['-payroll_period__year', '-payroll_period__month', 'employee'],
            },
        ),
        migrations.CreateModel(
            name='PayslipItem',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('item_type', models.CharField(choices=[('allowance', 'Tunjangan'), ('deduction', 'Potongan')], max_length=20)),
                ('name', models.CharField(max_length=100)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15)),
                ('description', models.CharField(blank=True, max_length=255)),
                ('payslip', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='hr.payslip')),
            ],
            options={
                'verbose_name': 'Payslip Item',
                'verbose_name_plural': 'Payslip Items',
                'ordering': ['payslip', 'item_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='SalaryComponent',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('component_type', models.CharField(max_length=20)),
                ('component_name', models.CharField(max_length=50)),
                ('amount', models.DecimalField(decimal_places=2, max_digits=15, validators=[django.core.validators.MinValueValidator(Decimal('0'))])),
                ('is_fixed', models.BooleanField(default=True, help_text='Komponen tetap setiap bulan')),
                ('effective_date', models.DateField()),
                ('end_date', models.DateField(blank=True, null=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='salary_components', to='hr.employee')),
            ],
            options={
                'verbose_name': 'Salary Component',
                'verbose_name_plural': 'Salary Components',
                'ordering': ['employee', 'component_type', 'component_name'],
            },
        ),
        migrations.CreateModel(
            name='Attendance',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('date', models.DateField(db_index=True)),
                ('check_in', models.DateTimeField(blank=True, null=True)),
                ('check_out', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('present', 'Hadir'), ('absent', 'Tidak Hadir'), ('late', 'Terlambat'), ('early_leave', 'Pulang Awal'), ('half_day', 'Setengah Hari'), ('wfh', 'Work From Home'), ('sick', 'Sakit'), ('leave', 'Cuti')], default='present', max_length=20)),
                ('work_hours', models.DecimalField(blank=True, decimal_places=2, help_text='Total jam kerja', max_digits=4, null=True)),
                ('overtime_hours', models.DecimalField(decimal_places=2, default=0, help_text='Jam lembur', max_digits=4)),
                ('notes', models.TextField(blank=True)),
                ('check_in_location', models.CharField(blank=True, max_length=255)),
                ('check_out_location', models.CharField(blank=True, max_length=255)),
                ('check_in_latitude', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('check_in_longitude', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('check_out_latitude', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('check_out_longitude', models.DecimalField(blank=True, decimal_places=7, max_digits=10, null=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendances', to='hr.employee')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Attendance',
                'verbose_name_plural': 'Attendances',
                'ordering': ['-date', 'employee'],
                'indexes': [models.Index(fields=['employee', 'date'], name='hr_attendan_employe_c63029_idx'), models.Index(fields=['date', 'status'], name='hr_attendan_date_36f853_idx'), models.Index(fields=['status'], name='hr_attendan_status_44ddfc_idx')],
                'unique_together': {('employee', 'date')},
            },
        ),
        migrations.CreateModel(
            name='AttendanceSummary',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('year', models.PositiveIntegerField()),
                ('month', models.PositiveIntegerField()),
                ('total_days', models.PositiveIntegerField(default=0)),
                ('present_days', models.PositiveIntegerField(default=0)),
                ('absent_days', models.PositiveIntegerField(default=0)),
                ('late_days', models.PositiveIntegerField(default=0)),
                ('leave_days', models.PositiveIntegerField(default=0)),
                ('sick_days', models.PositiveIntegerField(default=0)),
                ('wfh_days', models.PositiveIntegerField(default=0)),
                ('total_work_hours', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('total_overtime_hours', models.DecimalField(decimal_places=2, default=0, max_digits=6)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='attendance_summaries', to='hr.employee')),
            ],
            options={
                'verbose_name': 'Attendance Summary',
                'verbose_name_plural': 'Attendance Summaries',
                'ordering': ['-year', '-month', 'employee'],
                'indexes': [models.Index(fields=['employee', 'year', 'month'], name='hr_attendan_employe_8c97ff_idx'), models.Index(fields=['year', 'month'], name='hr_attendan_year_1545e1_idx')],
                'unique_together': {('employee', 'year', 'month')},
            },
        ),
        migrations.CreateModel(
            name='LeaveBalance',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('leave_type', models.CharField(choices=[('annual', 'Cuti Tahunan'), ('sick', 'Cuti Sakit'), ('maternity', 'Cuti Melahirkan'), ('paternity', 'Cuti Ayah'), ('marriage', 'Cuti Menikah'), ('bereavement', 'Cuti Duka'), ('unpaid', 'Cuti Tanpa Gaji'), ('special', 'Cuti Khusus'), ('religious', 'Cuti Keagamaan')], max_length=20)),
                ('year', models.PositiveIntegerField()),
                ('entitled_days', models.DecimalField(decimal_places=1, help_text='Jumlah hari yang berhak', max_digits=5)),
                ('used_days', models.DecimalField(decimal_places=1, default=0, help_text='Jumlah hari yang sudah digunakan', max_digits=5)),
                ('carried_over', models.DecimalField(decimal_places=1, default=0, help_text='Hari yang dibawa dari tahun sebelumnya', max_digits=5)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='leave_balances', to='hr.employee')),
            ],
            options={
                'verbose_name': 'Leave Balance',
                'verbose_name_plural': 'Leave Balances',
                'ordering': ['-year', 'employee', 'leave_type'],
                'indexes': [models.Index(fields=['employee', 'year'], name='hr_leavebal_employe_38d436_idx'), models.Index(fields=['year', 'leave_type'], name='hr_leavebal_year_1a5900_idx')],
                'unique_together': {('employee', 'leave_type', 'year')},
            },
        ),
        migrations.CreateModel(
            name='LeaveRequest',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('is_active', models.BooleanField(db_index=True, default=True)),
                ('leave_type', models.CharField(choices=[('annual', 'Cuti Tahunan'), ('sick', 'Cuti Sakit'), ('maternity', 'Cuti Melahirkan'), ('paternity', 'Cuti Ayah'), ('marriage', 'Cuti Menikah'), ('bereavement', 'Cuti Duka'), ('unpaid', 'Cuti Tanpa Gaji'), ('special', 'Cuti Khusus'), ('religious', 'Cuti Keagamaan')], max_length=20)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('total_days', models.DecimalField(decimal_places=1, max_digits=5)),
                ('reason', models.TextField()),
                ('status', models.CharField(choices=[('pending', 'Menunggu'), ('approved', 'Disetujui'), ('rejected', 'Ditolak'), ('cancelled', 'Dibatalkan')], default='pending', max_length=20)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True)),
                ('attachment', models.FileField(blank=True, null=True, upload_to='leave_attachments/')),
                ('emergency_contact_name', models.CharField(blank=True, max_length=100)),
                ('emergency_contact_phone', models.CharField(blank=True, max_length=20)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_leave_requests', to='hr.employee')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('delegate_to', models.ForeignKey(blank=True, help_text='Karyawan yang menggantikan selama cuti', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='delegated_leave_requests', to='hr.employee')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='leave_requests', to='hr.employee')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Leave Request',
                'verbose_name_plural': 'Leave Requests',
                'ordering': ['-created_at'],
                'indexes': [models.Index(fields=['employee', 'status'], name='hr_leavereq_employe_1b7929_idx'), models.Index(fields=['start_date', 'end_date'], name='hr_leavereq_start_d_9e9e54_idx'), models.Index(fields=['status'], name='hr_leavereq_status_694c52_idx'), models.Index(fields=['leave_type'], name='hr_leavereq_leave_t_773a43_idx')],
            },
        ),
        migrations.AddIndex(
            model_name='payrollperiod',
            index=models.Index(fields=['year', 'month'], name='hr_payrollp_year_4bd91c_idx'),
        ),
        migrations.AddIndex(
            model_name='payrollperiod',
            index=models.Index(fields=['status'], name='hr_payrollp_status_55dda7_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='payrollperiod',
            unique_together={('year', 'month')},
        ),
        migrations.AddIndex(
            model_name='payslip',
            index=models.Index(fields=['payroll_period', 'employee'], name='hr_payslip_payroll_8c6dee_idx'),
        ),
        migrations.AddIndex(
            model_name='payslip',
            index=models.Index(fields=['status'], name='hr_payslip_status_b65c3e_idx'),
        ),
        migrations.AddIndex(
            model_name='payslip',
            index=models.Index(fields=['employee', 'status'], name='hr_payslip_employe_2ed0f0_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='payslip',
            unique_together={('payroll_period', 'employee')},
        ),
        migrations.AddIndex(
            model_name='payslipitem',
            index=models.Index(fields=['payslip', 'item_type'], name='hr_payslipi_payslip_db7a43_idx'),
        ),
        migrations.AddIndex(
            model_name='salarycomponent',
            index=models.Index(fields=['employee', 'component_type'], name='hr_salaryco_employe_736ac5_idx'),
        ),
        migrations.AddIndex(
            model_name='salarycomponent',
            index=models.Index(fields=['effective_date', 'end_date'], name='hr_salaryco_effecti_ea8846_idx'),
        ),
    ]
